<section class="viewLevel" *ngIf="level">
    <krossr-level-editor-form *ngIf="level.currentView === 'new'" [error]="error" [level]="level" submitText="Submit" (sizeChange)="createGameArray()" (submitAction)="submitCreate()">
    </krossr-level-editor-form>
    <krossr-level-editor-form *ngIf="level.currentView === 'edit'" [error]="error" [level]="level" submitText="Update" (submitAction)="confirmUpdate($event)">
    </krossr-level-editor-form>

    <div class="rateLevel" *ngIf="Authentication.user && level && level.currentView === 'view'">
        Rate: <krossr-star-rating [rating]="level.userRating ? level.userRating.rating : 0" max="5" (ratingSelected)="rate($event)"></krossr-star-rating>
    </div>

    <krossr-mode-selector *ngIf="level && level.currentView === 'view'"></krossr-mode-selector>

    <div (keydown)="keydown($event)" (keyup)="keyup($event)" tabindex="0" [hidden]="!level || !level.ready">
        <div class="gameContainer-inner">
            <div class="top row">
                <krossr-number-grid
                    [gameMatrix]="gameMatrix['vertical']"
                    [goalMatrix]="goalMatrix['vertical']"
                    *ngIf="level && level.decodedLayout && level.currentView === 'view'"
                    orientation="vertical"
                    class="top-grid"
                    [ngStyle]="{'padding-right': margin}"></krossr-number-grid>
            </div>
            
            <div class="bottom row">
                <krossr-game [gameMatrix]="gameMatrix" [goalMatrix]="goalMatrix" [level]="level" [tiles]="finalLayout.tiles" *ngIf="finalLayout.tiles"></krossr-game>

                <krossr-number-grid
                    [gameMatrix]="gameMatrix['horizontal']"
                    [goalMatrix]="goalMatrix['horizontal']"
                    *ngIf="level && level.decodedLayout && level.currentView === 'view'"
                    orientation="horizontal"
                    class="left-grid"
                    [ngStyle]="{'padding-top': margin}">
                </krossr-number-grid>
            </div>
        </div>
    </div>
</section>